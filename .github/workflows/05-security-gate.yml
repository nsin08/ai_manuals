name: Security Gate

on:
  pull_request:
    types: [opened, synchronize]
    paths:
      - '**/auth/**'
      - '**/security/**'
      - '**/*secret*'
      - '**/*.key'
      - '**/*.pem'

permissions:
  pull-requests: write
  contents: read

jobs:
  security-review-required:
    runs-on: ubuntu-latest
    steps:
      - name: Request security review
        uses: actions/github-script@v7
        with:
          script: |
            const pr = context.payload.pull_request;
            
            await github.rest.issues.createComment({
              owner: context.repo.owner,
              repo: context.repo.repo,
              issue_number: pr.number,
              body: 'ðŸ”’ **Security Gate Triggered**: This PR modifies security-sensitive files.\n\n**Required:**\n- Security review by designated reviewer\n- No secrets in code\n- Security checklist complete\n\n@nsin08 - security review requested'
            });
            
            console.log('âœ… Security review requested');
